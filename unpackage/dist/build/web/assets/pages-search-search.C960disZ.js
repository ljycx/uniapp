import{X as e,Y as a,d as l,o as t,c as s,w as c,a as o,m as r,r as n,g as u,t as i,s as h,i as d,Z as m,q as p,I as f,b as y,L as _,M as v,z as g,e as b,f as k,F as x,N as w,O as C,n as S,j as V}from"./index-BwW5oSo7.js";import{_ as B}from"./uni-icons.Cgd90g6K.js";import{_ as $,r as F,g as z,l as I}from"./apis.-Vii-PU-.js";import{_ as T}from"./uni-tag.BtkjyLBo.js";import{_ as L}from"./uni-load-more.BNGZIGGe.js";const N={en:{"uni-search-bar.cancel":"cancel","uni-search-bar.placeholder":"Search enter content"},"zh-Hans":{"uni-search-bar.cancel":"取消","uni-search-bar.placeholder":"请输入搜索内容"},"zh-Hant":{"uni-search-bar.cancel":"取消","uni-search-bar.placeholder":"請輸入搜索內容"}},{t:j}=e(N);const H=$({name:"UniSearchBar",emits:["input","update:modelValue","clear","cancel","confirm","blur","focus"],props:{placeholder:{type:String,default:""},radius:{type:[Number,String],default:5},clearButton:{type:String,default:"auto"},cancelButton:{type:String,default:"auto"},cancelText:{type:String,default:""},bgColor:{type:String,default:"#F8F8F8"},textColor:{type:String,default:"#000000"},maxlength:{type:[Number,String],default:100},value:{type:[Number,String],default:""},modelValue:{type:[Number,String],default:""},focus:{type:Boolean,default:!1},readonly:{type:Boolean,default:!1}},data:()=>({show:!1,showSync:!1,searchVal:""}),computed:{cancelTextI18n(){return this.cancelText||j("uni-search-bar.cancel")},placeholderText(){return this.placeholder||j("uni-search-bar.placeholder")}},watch:{modelValue:{immediate:!0,handler(e){this.searchVal=e,e&&(this.show=!0)}},focus:{immediate:!0,handler(e){if(e){if(this.readonly)return;this.show=!0,this.$nextTick((()=>{this.showSync=!0}))}}},searchVal(e,a){this.$emit("input",e),this.$emit("update:modelValue",e)}},methods:{searchClick(){this.readonly||this.show||(this.show=!0,this.$nextTick((()=>{this.showSync=!0})))},clear(){this.searchVal="",this.$nextTick((()=>{this.$emit("clear",{value:""})}))},cancel(){this.readonly||(this.$emit("cancel",{value:this.searchVal}),this.searchVal="",this.show=!1,this.showSync=!1,a())},confirm(){a(),this.$emit("confirm",{value:this.searchVal})},blur(){a(),this.$emit("blur",{value:this.searchVal})},emitFocus(e){this.$emit("focus",e.detail)}}},[["render",function(e,a,f,y,_,v){const g=F(l("uni-icons"),B),b=d,k=m,x=p;return t(),s(b,{class:"uni-searchbar"},{default:c((()=>[o(b,{style:r({borderRadius:f.radius+"px",backgroundColor:f.bgColor}),class:"uni-searchbar__box",onClick:v.searchClick},{default:c((()=>[o(b,{class:"uni-searchbar__box-icon-search"},{default:c((()=>[n(e.$slots,"searchIcon",{},(()=>[o(g,{color:"#c0c4cc",size:"18",type:"search"})]),!0)])),_:3}),_.show||_.searchVal?(t(),s(k,{key:0,focus:_.showSync,disabled:f.readonly,placeholder:v.placeholderText,maxlength:f.maxlength,class:"uni-searchbar__box-search-input","confirm-type":"search",type:"text",modelValue:_.searchVal,"onUpdate:modelValue":a[0]||(a[0]=e=>_.searchVal=e),style:r({color:f.textColor}),onConfirm:v.confirm,onBlur:v.blur,onFocus:v.emitFocus},null,8,["focus","disabled","placeholder","maxlength","modelValue","style","onConfirm","onBlur","onFocus"])):(t(),s(x,{key:1,class:"uni-searchbar__text-placeholder"},{default:c((()=>[u(i(f.placeholder),1)])),_:1})),_.show&&("always"===f.clearButton||"auto"===f.clearButton&&""!==_.searchVal)&&!f.readonly?(t(),s(b,{key:2,class:"uni-searchbar__box-icon-clear",onClick:v.clear},{default:c((()=>[n(e.$slots,"clearIcon",{},(()=>[o(g,{color:"#c0c4cc",size:"20",type:"clear"})]),!0)])),_:3},8,["onClick"])):h("",!0)])),_:3},8,["style","onClick"]),"always"===f.cancelButton||_.show&&"auto"===f.cancelButton?(t(),s(x,{key:0,onClick:v.cancel,class:"uni-searchbar__cancel"},{default:c((()=>[u(i(v.cancelTextI18n),1)])),_:1},8,["onClick"])):h("",!0)])),_:3})}],["__scopeId","data-v-314f636a"]]),U=$({__name:"search",setup(e){let a=f("storageHistoryList")||[];const r=y(a),n=y(["美女","ai"]),i=y([]),m=y(!0),p=y({pageNum:1,pageSize:12,keyword:""}),$=e=>{let a=new Set([e.value,...r.value]);r.value=[...a],g("storageHistoryList",r.value),R()},N=e=>{p.value.keyword=e,$({value:e})},j=e=>{console.log("----input:",e)},U=e=>{w({title:"clear事件，清除值为："+e.value,icon:"none"})},M=e=>{},q=e=>{},O=e=>{p.value.keyword="",p.value.pageNum=1,i.value=[]},P=()=>{C({title:"请选择",content:"确认清除吗"}).then((e=>{e.confirm&&(r.value=[])}))},R=async()=>{_({title:"加载中"});let e=await I(p.value);i.value=[...i.value,...e.data],console.log("比较",p.value.pageSize,e.data.length),p.value.pageSize>e.data.length&&(m.value=!1),v(),g("storage_classList",i.value)};return z((()=>{m.value&&(p.value.pageNum++,R())})),(e,a)=>{const f=F(l("uni-search-bar"),H),y=d,_=F(l("uni-icons"),B),v=F(l("uni-tag"),T),g=V,w=F(l("uni-load-more"),L);return t(),s(y,{class:"layout"},{default:c((()=>[o(y,{class:"searchBar"},{default:c((()=>[o(f,{onConfirm:$,focus:!0,modelValue:p.value.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>p.value.keyword=e),onBlur:M,onFocus:q,onInput:j,onCancel:O,onClear:U},null,8,["modelValue"])])),_:1}),r.value.length&&!i.value.length?(t(),s(y,{key:0,class:"historySearch"},{default:c((()=>[o(y,{class:"titleBar"},{default:c((()=>[o(y,{class:"title"},{default:c((()=>[u(" 最近搜索 ")])),_:1}),o(y,{class:"icon",onClick:P},{default:c((()=>[o(_,{type:"trash-filled",size:"24",color:"rgb(115, 115, 115)"})])),_:1})])),_:1}),o(y,{class:"historyList"},{default:c((()=>[(t(!0),b(x,null,k(r.value,(e=>(t(),s(v,{text:e,onClick:a=>N(e)},null,8,["text","onClick"])))),256))])),_:1})])),_:1})):h("",!0),i.value.length?h("",!0):(t(),s(y,{key:1,class:"hotSearch"},{default:c((()=>[o(y,{class:"titleBar"},{default:c((()=>[o(y,{class:"title"},{default:c((()=>[u(" 热门搜索 ")])),_:1})])),_:1}),o(y,{class:"historyList"},{default:c((()=>[(t(!0),b(x,null,k(n.value,(e=>(t(),s(v,{text:e,onClick:a=>N(e)},null,8,["text","onClick"])))),256))])),_:1})])),_:1})),o(y,{class:"picList"},{default:c((()=>[(t(!0),b(x,null,k(i.value,(e=>(t(),s(y,{class:"picItem",key:e._id,onClick:a=>{return l=e._id,void S({url:"/pages/preview/preview?id="+l});var l}},{default:c((()=>[o(g,{src:e.smallPicurl,mode:"aspectFill"},null,8,["src"])])),_:2},1032,["onClick"])))),128))])),_:1}),!m.value&&i.value.length?(t(),s(y,{key:2,class:"loadLayout"},{default:c((()=>[o(w,{status:"noMore"})])),_:1})):h("",!0)])),_:1})}}},[["__scopeId","data-v-315596e0"]]);export{U as default};
